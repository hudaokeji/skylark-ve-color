/**
 * skylark-widgets-colorpicker - The skylark color picker widget
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylarkui/skylark-widgets-colorpicker/
 * @license MIT
 */
!function(e,t){var o=t.define,require=t.require,a="function"==typeof o&&o.amd,r=!a&&"undefined"!=typeof exports;if(!a&&!o){var s={};o=t.define=function(e,t,o){"function"==typeof o?(s[e]={factory:o,deps:t.map(function(t){return function(e,t){if("."!==e[0])return e;var o=t.split("/"),a=e.split("/");o.pop();for(var r=0;r<a.length;r++)"."!=a[r]&&(".."==a[r]?o.pop():o.push(a[r]));return o.join("/")}(t,e)}),resolved:!1,exports:null},require(e)):s[e]={factory:null,resolved:!0,exports:o}},require=t.require=function(e){if(!s.hasOwnProperty(e))throw new Error("Module "+e+" has not been defined");var module=s[e];if(!module.resolved){var o=[];module.deps.forEach(function(e){o.push(require(e))}),module.exports=module.factory.apply(t,o)||null,module.resolved=!0}return module.exports}}if(!o)throw new Error("The module utility (ex: requirejs or skylark-utils) is not loaded!");if(function(e,require){e("skylark-widgets-colorpicker/ColorPicker",["skylark-langx/skylark","skylark-langx/langx","skylark-domx-browser","skylark-domx-noder","skylark-domx-eventer","skylark-domx-finder","skylark-domx-query","skylark-data-color/colors","skylark-data-color/Color","skylark-widgets-base/Widget"],function(e,t,o,a,r,s,l,i,n,c){"use strict";var d=t.noop,p={beforeShow:d,move:d,change:d,show:d,hide:d,color:!1,flat:!1,showInput:!1,allowEmpty:!1,showButtons:!0,clickoutFiresChange:!0,showInitial:!1,showPalette:!1,showPaletteOnly:!1,hideAfterPaletteSelect:!1,togglePaletteOnly:!1,showSelectionPalette:!0,localStorageKey:!1,appendTo:"body",maxSelectionSize:7,cancelText:"cancel",chooseText:"choose",togglePaletteMoreText:"more",togglePaletteLessText:"less",clearText:"Clear Color Selection",noColorSelectedText:"No Color Selected",preferredFormat:!1,className:"",containerClassName:"",replacerClassName:"",showAlpha:!1,theme:"sp-light",palette:[["#ffffff","#000000","#ff0000","#ff8000","#ffff00","#008000","#0000ff","#4b0082","#9400d3"]],selectionPalette:[],disabled:!1,offset:null},f=[],h=["<div class='sp-replacer'>","<div class='sp-preview'><div class='sp-preview-inner'></div></div>","<div class='sp-dd'>&#9660;</div>","</div>"].join(""),u=function(){var e="";if(o.isIE)for(var t=1;t<=6;t++)e+="<div class='sp-"+t+"'></div>";return["<div class='sp-container sp-hidden'>","<div class='sp-palette-container'>","<div class='sp-palette sp-thumb sp-cf'></div>","<div class='sp-palette-button-container sp-cf'>","<button type='button' class='sp-palette-toggle'></button>","</div>","</div>","<div class='sp-picker-container'>","<div class='sp-top sp-cf'>","<div class='sp-fill'></div>","<div class='sp-top-inner'>","<div class='sp-color'>","<div class='sp-sat'>","<div class='sp-val'>","<div class='sp-dragger'></div>","</div>","</div>","</div>","<div class='sp-clear sp-clear-display'>","</div>","<div class='sp-hue'>","<div class='sp-slider'></div>",e,"</div>","</div>","<div class='sp-alpha'><div class='sp-alpha-inner'><div class='sp-alpha-handle'></div></div></div>","</div>","<div class='sp-input-container sp-cf'>","<input class='sp-input' type='text' spellcheck='false'  />","</div>","<div class='sp-initial sp-thumb sp-cf'></div>","<div class='sp-button-container sp-cf'>","<a class='sp-cancel' href='#'></a>","<button type='button' class='sp-choose'></button>","</div>","</div>","</div>"].join("")}();function g(e,t,o,a){for(var r=[],s=0;s<e.length;s++){var c=e[s];if(c){var d=i.Color(c),p=d.toHsl().l<.5?"sp-thumb-el sp-thumb-dark":"sp-thumb-el sp-thumb-light";p+=n.equals(t,c)?" sp-thumb-active":"";var f=d.toString(a.preferredFormat||"rgb"),h="background-color:"+d.toRgbString();r.push('<span title="'+f+'" data-color="'+d.toRgbString()+'" class="'+p+'"><span class="sp-thumb-inner" style="'+h+';" /></span>')}else{r.push(l("<div />").append(l('<span data-color="" style="background-color:transparent;" class="sp-clear-display"></span>').attr("title",a.noColorSelectedText)).html())}}return"<div class='sp-cf "+o+"'>"+r.join("")+"</div>"}var v=t.Evented.inherit({klassName:"ColorPicker",init:function(e,a){var s=function(e,o){var a=t.mixin({},p,e);return a.callbacks={move:w(a.move,o),change:w(a.change,o),show:w(a.show,o),hide:w(a.hide,o),beforeShow:w(a.beforeShow,o)},a}(a,e),c=s.flat,d=s.showSelectionPalette,v=s.localStorageKey,m=s.theme,y=s.callbacks,b=t.debounce(He,10),C=!1,x=!1,P=0,S=0,T=0,M=0,z=0,F=0,E=0,O=0,j=0,A=0,I=1,R=[],D=[],N={},q=s.selectionPalette.slice(0),H=s.maxSelectionSize,L="sp-dragging",_=null,K=e.ownerDocument,W=(K.body,l(e)),B=!1,V=l(u,K).addClass(m),G=V.find(".sp-picker-container"),J=V.find(".sp-color"),Q=V.find(".sp-dragger"),U=V.find(".sp-hue"),X=V.find(".sp-slider"),Y=V.find(".sp-alpha-inner"),Z=V.find(".sp-alpha"),$=V.find(".sp-alpha-handle"),ee=V.find(".sp-input"),te=V.find(".sp-palette"),oe=V.find(".sp-initial"),ae=V.find(".sp-cancel"),re=V.find(".sp-clear"),se=V.find(".sp-choose"),le=V.find(".sp-palette-toggle"),ie=W.is("input"),ne=ie&&"color"===W.attr("type")&&inputTypeColorSupport(),ce=ie&&!c,de=ce?l(h).addClass(m).addClass(s.className).addClass(s.replacerClassName):l([]),pe=ce?de:W,fe=de.find(".sp-preview-inner"),he=s.color||ie&&W.val(),ue=!1,ge=s.preferredFormat,ve=!s.showButtons||s.clickoutFiresChange,ke=!he,we=s.allowEmpty&&!ne;function me(){if(s.showPaletteOnly&&(s.showPalette=!0),le.text(s.showPaletteOnly?s.togglePaletteMoreText:s.togglePaletteLessText),s.palette){R=s.palette.slice(0),D=t.isArray(R[0])?R:[R],N={};for(var e=0;e<D.length;e++)for(var o=0;o<D[e].length;o++){var a=n(D[e][o]).toRgbString();N[a]=!0}}V.toggleClass("sp-flat",c),V.toggleClass("sp-input-disabled",!s.showInput),V.toggleClass("sp-alpha-enabled",s.showAlpha),V.toggleClass("sp-clear-enabled",we),V.toggleClass("sp-buttons-disabled",!s.showButtons),V.toggleClass("sp-palette-buttons-disabled",!s.togglePaletteOnly),V.toggleClass("sp-palette-disabled",!s.showPalette),V.toggleClass("sp-palette-only",s.showPaletteOnly),V.toggleClass("sp-initial-disabled",!s.showInitial),V.addClass(s.className).addClass(s.containerClassName),He()}function ye(){if(v&&window.localStorage){try{var e=window.localStorage[v].split(",#");e.length>1&&(delete window.localStorage[v],t.each(e,function(e,t){be(t)}))}catch(e){}try{q=window.localStorage[v].split(";")}catch(e){}}}function be(e){if(d){var o=n(e).toRgbString();if(!N[o]&&-1===t.inArray(o,q))for(q.push(o);q.length>H;)q.shift();if(v&&window.localStorage)try{window.localStorage[v]=q.join(";")}catch(e){}}}function Ce(){var e=Ie(),o=t.map(D,function(t,o){return g(t,e,"sp-palette-row sp-palette-row-"+o,s)});ye(),q&&o.push(g(function(){var e=[];if(s.showPalette)for(var t=0;t<q.length;t++){var o=n(q[t]).toRgbString();N[o]||e.push(q[t])}return e.reverse().slice(0,s.maxSelectionSize)}(),e,"sp-palette-row sp-palette-row-selection",s)),te.html(o.join(""))}function xe(){if(s.showInitial){var e=ue,t=Ie();oe.html(g([e,t],t,"sp-palette-row-initial",s))}}function Pe(){(S<=0||P<=0||M<=0)&&He(),x=!0,V.addClass(L),_=null,W.trigger("dragstart.ColorPicker",[Ie()])}function Se(){x=!1,V.removeClass(L),W.trigger("dragstop.ColorPicker",[Ie()])}function Te(){var e=ee.val();if(null!==e&&""!==e||!we){var t=n(e);t.isValid()?(Ae(t),Re(),qe()):ee.addClass("sp-validation-error")}else Ae(null),Re(),qe()}function Me(){C?Oe():ze()}function ze(){var e=r.create("beforeShow.ColorPicker");C?He():(W.trigger(e,[Ie()]),!1===y.beforeShow(Ie())||e.isDefaultPrevented()||(!function(){for(var e=0;e<f.length;e++)f[e]&&f[e].hide()}(),C=!0,l(K).on("keydown.ColorPicker",Fe),l(K).on("click.ColorPicker",Ee),l(window).on("resize.ColorPicker",b),de.addClass("sp-active"),V.removeClass("sp-hidden"),He(),De(),ue=Ie(),xe(),y.show(ue),W.trigger("show.ColorPicker",[ue])))}function Fe(e){27===e.keyCode&&Oe()}function Ee(e){2!=e.button&&(x||(ve?qe(!0):je(),Oe()))}function Oe(){C&&!c&&(C=!1,l(K).off("keydown.ColorPicker",Fe),l(K).off("click.ColorPicker",Ee),l(window).off("resize.ColorPicker",b),de.removeClass("sp-active"),V.addClass("sp-hidden"),y.hide(Ie()),W.trigger("hide.ColorPicker",[Ie()]))}function je(){Ae(ue,!0),qe(!0)}function Ae(e,t){var o,a;n.equals(e,Ie())?De():(!e&&we?ke=!0:(ke=!1,o=i.Color(e),a=o.toHsv(),O=a.h%360/360,j=a.s,A=a.v,I=a.a),De(),o&&o.isValid()&&!t&&(ge=s.preferredFormat||o.getFormat()))}function Ie(e){return e=e||{},we&&ke?null:n.fromRatio({h:O,s:j,v:A,a:Math.round(1e3*I)/1e3},{format:e.format||ge})}function Re(){De(),y.move(Ie()),W.trigger("move.ColorPicker",[Ie()])}function De(){ee.removeClass("sp-validation-error"),Ne();var e=n.fromRatio({h:O,s:1,v:1});J.css("background-color",e.toHexString());var t=ge;I<1&&(0!==I||"name"!==t)&&("hex"!==t&&"hex3"!==t&&"hex6"!==t&&"name"!==t||(t="rgb"));var a=Ie({format:t}),r="";if(fe.removeClass("sp-clear-display"),fe.css("background-color","transparent"),!a&&we)fe.addClass("sp-clear-display");else{var l=a.toHexString(),i=a.toRgbString();if(fe.css("background-color",i),s.showAlpha){var c=a.toRgb();c.a=0;var d=n(c).toRgbString(),p="linear-gradient(left, "+d+", "+l+")";o.isIE?Y.css("filter",n(d).toFilter({gradientType:1},l)):(Y.css("background","-webkit-"+p),Y.css("background","-moz-"+p),Y.css("background","-ms-"+p),Y.css("background","linear-gradient(to right, "+d+", "+l+")"))}r=a.toString(t)}s.showInput&&ee.val(r),s.showPalette&&Ce(),xe()}function Ne(){var e=j,t=A;if(we&&ke)$.hide(),X.hide(),Q.hide();else{$.show(),X.show(),Q.show();var o=e*P,a=S-t*S;o=Math.max(-T,Math.min(P-T,o-T)),a=Math.max(-T,Math.min(S-T,a-T)),Q.css({top:a+"px",left:o+"px"});var r=I*z;$.css({left:r-F/2+"px"});var s=O*M;X.css({top:s-E+"px"})}}function qe(e){var t=Ie(),o="",a=!n.equals(t,ue);t&&(o=t.toString(ge),be(t)),ie&&W.val(o),e&&a&&(y.change(t),W.trigger("change",[t]))}function He(){var e,t,o,a,r,i,n,d,p,f,h,u;C&&(P=J.width(),S=J.height(),T=Q.height(),U.width(),M=U.height(),E=X.height(),z=Z.width(),F=$.width(),c||(V.css("position","absolute"),s.offset?V.offset(s.offset):V.offset((t=pe,o=(e=V).outerWidth(),a=e.outerHeight(),r=t.outerHeight(),i=e[0].ownerDocument,n=i.documentElement,d=n.clientWidth+l(i).scrollLeft(),p=n.clientHeight+l(i).scrollTop(),f=t.offset(),h=f.left,u=f.top,u+=r,h-=Math.min(h,h+o>d&&d>o?Math.abs(h+o-d):0),{top:u-=Math.min(u,u+a>p&&p>a?Math.abs(a+r-0):0),bottom:f.bottom,left:h,right:f.right,width:f.width,height:f.height}))),Ne(),s.showPalette&&Ce(),W.trigger("reflow.ColorPicker"))}function Le(){Oe(),B=!0,W.attr("disabled",!0),pe.addClass("sp-disabled")}!function(){o.isIE&&V.find("*:not(input)").attr("unselectable","on");me(),ce&&W.after(de).hide();we||re.hide();if(c)W.after(V).hide();else{var e="parent"===s.appendTo?W.parent():l(s.appendTo);1!==e.length&&(e=l("body")),e.append(V)}ye(),pe.on("click.ColorPicker touchstart.ColorPicker",function(e){B||Me(),e.stopPropagation(),l(e.target).is("input")||e.preventDefault()}),(W.is(":disabled")||!0===s.disabled)&&Le();V.click(k),ee.change(Te),ee.on("paste",function(){setTimeout(Te,1)}),ee.keydown(function(e){13==e.keyCode&&Te()}),ae.text(s.cancelText),ae.on("click.ColorPicker",function(e){e.stopPropagation(),e.preventDefault(),je(),Oe()}),re.attr("title",s.clearText),re.on("click.ColorPicker",function(e){e.stopPropagation(),e.preventDefault(),ke=!0,Re(),c&&qe(!0)}),se.text(s.chooseText),se.on("click.ColorPicker",function(e){e.stopPropagation(),e.preventDefault(),o.isIE&&ee.is(":focus")&&ee.trigger("change"),ee.hasClass("sp-validation-error")||(qe(!0),Oe())}),le.text(s.showPaletteOnly?s.togglePaletteMoreText:s.togglePaletteLessText),le.on("click.spectrum",function(e){e.stopPropagation(),e.preventDefault(),s.showPaletteOnly=!s.showPaletteOnly,s.showPaletteOnly||c||V.css("left","-="+(G.outerWidth(!0)+5)),me()}),draggable(Z,function(e,t,o){I=e/z,ke=!1,o.shiftKey&&(I=Math.round(10*I)/10),Re()},Pe,Se),draggable(U,function(e,t){O=parseFloat(t/M),ke=!1,s.showAlpha||(I=1),Re()},Pe,Se),draggable(J,function(e,t,o){if(o.shiftKey){if(!_){var a=j*P,r=S-A*S,l=Math.abs(e-a)>Math.abs(t-r);_=l?"x":"y"}}else _=null;var i=!_||"y"===_;(!_||"x"===_)&&(j=parseFloat(e/P)),i&&(A=parseFloat((S-t)/S)),ke=!1,s.showAlpha||(I=1),Re()},Pe,Se),he?(Ae(he),De(),ge=s.preferredFormat||n(he).format,be(he)):De();c&&ze();function t(e){return e.data&&e.data.ignore?(Ae(l(e.target).closest(".sp-thumb-el").data("color")),Re()):(Ae(l(e.target).closest(".sp-thumb-el").data("color")),Re(),s.hideAfterPaletteSelect?(qe(!0),Oe()):qe()),!1}var a=o.isIE?"mousedown.ColorPicker":"click.ColorPicker touchstart.ColorPicker";te.on(a,".sp-thumb-el",t),oe.on(a,".sp-thumb-el:nth-child(1)",{ignore:!0},t)}();var _e={show:ze,hide:Oe,toggle:Me,reflow:He,option:function(e,o){if(void 0===e)return t.mixin({},s);if(void 0===o)return s[e];s[e]=o,"preferredFormat"===e&&(ge=s.preferredFormat);me()},enable:function(){B=!1,W.attr("disabled",!1),pe.removeClass("sp-disabled")},disable:Le,offset:function(e){s.offset=e,He()},set:function(e){Ae(e),qe()},get:Ie,destroy:function(){W.show(),pe.off("click.ColorPicker touchstart.ColorPicker"),V.remove(),de.remove(),f[_e.id]=null},container:V};return _e.id=f.push(_e)-1,_e}});function k(e){e.stopPropagation()}function w(e,t){var o=Array.prototype.slice,a=o.call(arguments,2);return function(){return e.apply(t,a.concat(o.call(arguments)))}}var m="ColorPicker.id";return v.load=!0,v.loadOpts={},v.draggable=draggable,v.defaults=p,v.localization={},v.palettes={},l.fn.colorPicker=function(e,o){if("string"==typeof e){var a=this,r=Array.prototype.slice.call(arguments,1);return this.each(function(){var t=f[l(this).data(m)];if(t){var o=t[e];if(!o)throw new Error("skylark-ui-colorpicker: no such method: '"+e+"'");"get"==e?a=t.get():"container"==e?a=t.container:"option"==e?a=t.option.apply(t,r):"destroy"==e?(t.destroy(),l(this).removeData(m)):o.apply(t,r)}}),a}return this.colorPicker("destroy").each(function(){var o=t.mixin({},l(this).data(),e),a=v(this,o);l(this).data(m,a.id)})},e.attach("widgets.ColorPicker",v)}),e("skylark-widgets-colorpicker/i18n/texts_ja",["../ColorPicker"],function(e){var t=e.localization.ja={cancelText:"中止",chooseText:"選択"};return t}),e("skylark-widgets-colorpicker/i18n/texts_zh-cn",["../ColorPicker"],function(e){var t=e.localization["zh-cn"]={cancelText:"取消",chooseText:"选择",clearText:"清除",togglePaletteMoreText:"更多选项",togglePaletteLessText:"隐藏",noColorSelectedText:"尚未选择任何颜色"};return t}),e("skylark-widgets-colorpicker/i18n/texts_zh-tw",["../ColorPicker"],function(e){var t=e.localization["zh-tw"]={cancelText:"取消",chooseText:"選擇",clearText:"清除",togglePaletteMoreText:"更多選項",togglePaletteLessText:"隱藏",noColorSelectedText:"尚未選擇任何顏色"};return t}),e("skylark-widgets-colorpicker/main",["./ColorPicker","./i18n/texts_ja","./i18n/texts_zh-cn","./i18n/texts_zh-tw"],function(e){return e}),e("skylark-widgets-colorpicker",["skylark-widgets-colorpicker/main"],function(e){return e})}(o),!a){var l=require("skylark-langx/skylark");r?module.exports=l:t.skylarkjs=l}}(0,this);
//# sourceMappingURL=sourcemaps/skylark-widgets-colorpicker.js.map
