/**
 * skylark-domx-colorer - The skylark dom plugin for picking color 
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-domx/skylark-domx-colorer/
 * @license MIT
 */
!function(e,t){var o=t.define,require=t.require,s="function"==typeof o&&o.amd,a=!s&&"undefined"!=typeof exports;if(!s&&!o){var r={};o=t.define=function(e,t,o){"function"==typeof o?(r[e]={factory:o,deps:t.map(function(t){return function(e,t){if("."!==e[0])return e;var o=t.split("/"),s=e.split("/");o.pop();for(var a=0;a<s.length;a++)"."!=s[a]&&(".."==s[a]?o.pop():o.push(s[a]));return o.join("/")}(t,e)}),resolved:!1,exports:null},require(e)):r[e]={factory:null,resolved:!0,exports:o}},require=t.require=function(e){if(!r.hasOwnProperty(e))throw new Error("Module "+e+" has not been defined");var module=r[e];if(!module.resolved){var o=[];module.deps.forEach(function(e){o.push(require(e))}),module.exports=module.factory.apply(t,o)||null,module.resolved=!0}return module.exports}}if(!o)throw new Error("The module utility (ex: requirejs or skylark-utils) is not loaded!");if(function(e,require){e("skylark-domx-colorer/Indicator",["skylark-langx/skylark","skylark-langx/langx","skylark-domx-browser","skylark-domx-noder","skylark-domx-eventer","skylark-domx-finder","skylark-domx-query","skylark-domx-plugins"],function(e,t,o,s,a,r,i,l){var n=l.Plugin.inherit({klassName:"Indicator",pluginName:"domx.indicator",options:{},_construct:function(e,t){this.overrided(e,t),this.listenTo(this.elmx(),"mousedown",e=>{this._start(e)})},_move:function(e){if(this._dragging){var t=this._offset,o=e.pageX,s=e.pageY,a=this._maxWidth,r=this._maxHeight,i=Math.max(0,Math.min(o-t.left,a)),l=Math.max(0,Math.min(s-t.top,r)),n=this.options.onmove;n&&n.apply(this._elm,[i,l,e])}},_start:function(e){var t=e.which?3==e.which:2==e.button;if(!t&&!this._dragging){var o=this.options.onstart;if(!o||!1!==o.apply(this._elm,arguments)){this._dragging=!0;var s=this.$();this._maxHeight=s.height(),this._maxWidth=s.width(),this._offset=s.offset();var r=this.$(document);this.listenTo(r,{mousemove:e=>{this._move(e)},mouseup:e=>{this._stop(e)}}),r.find("body").addClass("sp-dragging"),this._move(e),a.stop(e)}}},_stop:function(e){var t=this.$(document);this._dragging&&(this.unlistenTo(t),t.find("body").removeClass("sp-dragging"),onstop=this.options.onstop,onstop&&this._delay(function(){onstop.apply(this._elm,arguments)})),this._dragging=!1}});return l.register(n),n}),e("skylark-domx-colorer/ColorPicker",["skylark-langx/skylark","skylark-langx/langx","skylark-domx-browser","skylark-domx-noder","skylark-domx-finder","skylark-domx-query","skylark-domx-eventer","skylark-domx-styler","skylark-domx-fx","skylark-domx-plugins","skylark-domx-popups","skylark-graphics-color","./Indicator"],function(e,t,o,s,a,r,i,l,n,c,d,p,h){"use strict";var f=t.noop,u=[],g=["<div class='sp-replacer'>","<div class='sp-preview'><div class='sp-preview-inner'></div></div>","<div class='sp-dd'>&#9660;</div>","</div>"].join(""),v=function(){var e="";if(o.isIE)for(var t=1;t<=6;t++)e+="<div class='sp-"+t+"'></div>";return["<div class='sp-container sp-hidden'>","<div class='sp-palette-container'>","<div class='sp-palette sp-thumb sp-cf'></div>","<div class='sp-palette-button-container sp-cf'>","<button type='button' class='sp-palette-toggle'></button>","</div>","</div>","<div class='sp-picker-container'>","<div class='sp-top sp-cf'>","<div class='sp-fill'></div>","<div class='sp-top-inner'>","<div class='sp-color'>","<div class='sp-sat'>","<div class='sp-val'>","<div class='sp-dragger'></div>","</div>","</div>","</div>","<div class='sp-clear sp-clear-display'>","</div>","<div class='sp-hue'>","<div class='sp-slider'></div>",e,"</div>","</div>","<div class='sp-alpha'><div class='sp-alpha-inner'><div class='sp-alpha-handle'></div></div></div>","</div>","<div class='sp-input-container sp-cf'>","<input class='sp-input' type='text' spellcheck='false'  />","</div>","<div class='sp-initial sp-thumb sp-cf'></div>","<div class='sp-button-container sp-cf'>","<a class='sp-cancel' href='#'></a>","<button type='button' class='sp-choose'></button>","</div>","</div>","</div>"].join("")}();function m(e,t,o,s){for(var a=[],i=0;i<e.length;i++){var l=e[i];if(l){var n=p.parse(l),c=n.toHsl().l<.5?"sp-thumb-el sp-thumb-dark":"sp-thumb-el sp-thumb-light";c+=p.equals(t,l)?" sp-thumb-active":"";var d=n.toString(s.preferredFormat||"rgb"),h="background-color:"+n.toRgbString();a.push('<span title="'+d+'" data-color="'+n.toRgbString()+'" class="'+c+'"><span class="sp-thumb-inner" style="'+h+';" /></span>')}else{a.push(r("<div />").append(r('<span data-color="" style="background-color:transparent;" class="sp-clear-display"></span>').attr("title",s.noColorSelectedText)).html())}}return"<div class='sp-cf "+o+"'>"+a.join("")+"</div>"}var k=c.Plugin.inherit({klassName:"ColorPicker",pluginName:"domx.colorPicker",options:{beforeShow:f,move:f,change:f,show:f,hide:f,color:!1,flat:!1,showInput:!1,allowEmpty:!1,showButtons:!0,clickoutFiresChange:!0,showInitial:!1,showPalette:!1,showPaletteOnly:!1,hideAfterPaletteSelect:!1,togglePaletteOnly:!1,showSelectionPalette:!0,localStorageKey:!1,appendTo:"body",maxSelectionSize:7,cancelText:"cancel",chooseText:"choose",togglePaletteMoreText:"more",togglePaletteLessText:"less",clearText:"Clear Color Selection",noColorSelectedText:"No Color Selected",preferredFormat:!1,className:"",containerClassName:"",replacerClassName:"",showAlpha:!1,theme:"sp-light",palette:[["#ffffff","#000000","#ff0000","#ff8000","#ffff00","#008000","#0000ff","#4b0082","#9400d3"]],selectionPalette:[],disabled:!1,offset:null},_construct:function(e,s){this.overrided(e,s);var a=this.options,l=this._elm,n=a.flat,c=a.showSelectionPalette,h=a.theme,f=t.debounce(qe,10),k=!1,w=!1,b=0,C=0,P=0,T=0,S=0,_=0,M=0,z=0,F=0,I=0,N=1,O=[],j=[],A={},E=a.selectionPalette.slice(0),q=a.maxSelectionSize,R="sp-dragging",D=null,H=a.callbacks={move:y(a.move,e),change:y(a.change,e),show:y(a.show,e),hide:y(a.hide,e),beforeShow:y(a.beforeShow,e)},L=l.ownerDocument,B=(L.body,r(l)),K=!1,W=r(v,L).addClass(h),$=W.find(".sp-picker-container"),V=W.find(".sp-color"),X=W.find(".sp-dragger"),Y=W.find(".sp-hue"),G=W.find(".sp-slider"),J=W.find(".sp-alpha-inner"),Q=W.find(".sp-alpha"),U=W.find(".sp-alpha-handle"),Z=W.find(".sp-input"),ee=W.find(".sp-palette"),te=W.find(".sp-initial"),oe=W.find(".sp-cancel"),se=W.find(".sp-clear"),ae=W.find(".sp-choose"),re=W.find(".sp-palette-toggle"),ie=B.is("input"),le=ie&&"color"===B.attr("type")&&inputTypeColorSupport(),ne=ie&&!n,ce=ne?r(g).addClass(h).addClass(a.className).addClass(a.replacerClassName):r([]),de=ne?ce:B,pe=ce.find(".sp-preview-inner"),he=a.color||ie&&B.val(),fe=!1,ue=a.preferredFormat,ge=!a.showButtons||a.clickoutFiresChange,ve=!he,me=a.allowEmpty&&!le;function ke(){if(a.showPaletteOnly&&(a.showPalette=!0),re.text(a.showPaletteOnly?a.togglePaletteMoreText:a.togglePaletteLessText),a.palette){O=a.palette.slice(0),j=t.isArray(O[0])?O:[O],A={};for(var e=0;e<j.length;e++)for(var o=0;o<j[e].length;o++){var s=p.parse(j[e][o]).toRgbString();A[s]=!0}}W.toggleClass("sp-flat",n),W.toggleClass("sp-input-disabled",!a.showInput),W.toggleClass("sp-alpha-enabled",a.showAlpha),W.toggleClass("sp-clear-enabled",me),W.toggleClass("sp-buttons-disabled",!a.showButtons),W.toggleClass("sp-palette-buttons-disabled",!a.togglePaletteOnly),W.toggleClass("sp-palette-disabled",!a.showPalette),W.toggleClass("sp-palette-only",a.showPaletteOnly),W.toggleClass("sp-initial-disabled",!a.showInitial),W.addClass(a.className).addClass(a.containerClassName),qe()}function xe(e){if(c){var o=p.parse(e).toRgbString();if(!A[o]&&-1===t.inArray(o,E))for(E.push(o);E.length>q;)E.shift()}}function ye(){var e=Ne(),o=t.map(j,function(t,o){return m(t,e,"sp-palette-row sp-palette-row-"+o,a)});E&&o.push(m(function(){var e=[];if(a.showPalette)for(var t=0;t<E.length;t++){var o=p.parse(E[t]).toRgbString();A[o]||e.push(E[t])}return e.reverse().slice(0,a.maxSelectionSize)}(),e,"sp-palette-row sp-palette-row-selection",a)),ee.html(o.join(""))}function we(){if(a.showInitial){var e=fe,t=Ne();te.html(m([e,t],t,"sp-palette-row-initial",a))}}function be(){(C<=0||b<=0||T<=0)&&qe(),w=!0,W.addClass(R),D=null,B.trigger("dragstart.ColorPicker",[Ne()])}function Ce(){w=!1,W.removeClass(R),B.trigger("dragstop.ColorPicker",[Ne()])}function Pe(){var e=Z.val();if(null!==e&&""!==e||!me){var t=p.parse(e);t.isValid()?(Ie(t),Oe(),Ee()):Z.addClass("sp-validation-error")}else Ie(null),Oe(),Ee()}function Te(e){27===e.keyCode&&ze()}function Se(e){2!=e.button&&(w||(ge?Ee(!0):Fe(),ze()))}function _e(){k?ze():Me()}function Me(){var e=i.create("beforeShow.ColorPicker");k?qe():(B.trigger(e,[Ne()]),!1===H.beforeShow(Ne())||e.isDefaultPrevented()||(!function(){for(var e=0;e<u.length;e++)u[e]&&u[e].hide()}(),k=!0,r(L).on("keydown.ColorPicker",Te),r(L).on("click.ColorPicker",Se),r(window).on("resize.ColorPicker",f),ce.addClass("sp-active"),W.removeClass("sp-hidden"),qe(),je(),fe=Ne(),we(),H.show(fe),B.trigger("show.ColorPicker",[fe])))}function ze(){k&&!n&&(k=!1,r(L).off("keydown.ColorPicker",Te),r(L).off("click.ColorPicker",Se),r(window).off("resize.ColorPicker",f),ce.removeClass("sp-active"),W.addClass("sp-hidden"),H.hide(Ne()),B.trigger("hide.ColorPicker",[Ne()]))}function Fe(){Ie(fe,!0),Ee(!0)}function Ie(e,t){var o,s;p.equals(e,Ne())?je():(!e&&me?ve=!0:(ve=!1,o=p.parse(e),s=o.toHsv(),z=s.h%360/360,F=s.s,I=s.v,N=s.a),je(),o&&o.isValid()&&!t&&(ue=a.preferredFormat||o.getFormat()))}function Ne(e){return e=e||{},me&&ve?null:p.parse({h:360*z,s:F,v:I,a:Math.round(1e3*N)/1e3})}function Oe(){je(),H.move(Ne()),B.trigger("move.ColorPicker",[Ne()])}function je(){Z.removeClass("sp-validation-error"),Ae();var e=p.parse({h:360*z,s:1,v:1});V.css("background-color",e.toHexString());var t=ue;N<1&&(0!==N||"name"!==t)&&("hex"!==t&&"hex3"!==t&&"hex6"!==t&&"name"!==t||(t="rgb"));var s=Ne({format:t}),r="";if(pe.removeClass("sp-clear-display"),pe.css("background-color","transparent"),!s&&me)pe.addClass("sp-clear-display");else{var i=s.toHexString(),l=s.toRgbString();if(pe.css("background-color",l),a.showAlpha){var n=s.toRgb();n.a=0;var c=p.parse(n).toRgbString(),d="linear-gradient(left, "+c+", "+i+")";o.isIE?J.css("filter",p.parse(c).toFilter({gradientType:1},i)):(J.css("background","-webkit-"+d),J.css("background","-moz-"+d),J.css("background","-ms-"+d),J.css("background","linear-gradient(to right, "+c+", "+i+")"))}r=s.toString(t)}a.showInput&&Z.val(r),a.showPalette&&ye(),we()}function Ae(){var e=F,t=I;if(me&&ve)U.hide(),G.hide(),X.hide();else{U.show(),G.show(),X.show();var o=e*b,s=C-t*C;o=Math.max(-P,Math.min(b-P,o-P)),s=Math.max(-P,Math.min(C-P,s-P)),X.css({top:s+"px",left:o+"px"});var a=N*S;U.css({left:a-_/2+"px"});var r=z*T;G.css({top:r-M+"px"})}}function Ee(e){var t=Ne(),o="",s=!p.equals(t,fe);t&&(o=t.toString(ue),xe(t)),ie&&B.val(o),e&&s&&(H.change(t),B.trigger("change",[t]))}function qe(){k&&(b=V.width(),C=V.height(),P=X.height(),Y.width(),T=Y.height(),M=G.height(),S=Q.width(),_=U.width(),n||(W.css("position","absolute"),a.offset?W.offset(a.offset):W.offset(d.calcOffset(W[0],de[0]))),Ae(),a.showPalette&&ye(),B.trigger("reflow.ColorPicker"))}function Re(){ze(),K=!0,B.attr("disabled",!0),de.addClass("sp-disabled")}!function(){o.isIE&&W.find("*:not(input)").attr("unselectable","on");ke(),ne&&B.after(ce).hide();me||se.hide();if(n)B.after(W).hide();else{var e="parent"===a.appendTo?B.parent():r(a.appendTo);1!==e.length&&(e=r("body")),e.append(W)}de.on("click.ColorPicker touchstart.ColorPicker",function(e){K||_e(),e.stopPropagation(),r(e.target).is("input")||e.preventDefault()}),(B.is(":disabled")||!0===a.disabled)&&Re();W.click(x),Z.change(Pe),Z.on("paste",function(){setTimeout(Pe,1)}),Z.keydown(function(e){13==e.keyCode&&Pe()}),oe.text(a.cancelText),oe.on("click.ColorPicker",function(e){e.stopPropagation(),e.preventDefault(),Fe(),ze()}),se.attr("title",a.clearText),se.on("click.ColorPicker",function(e){e.stopPropagation(),e.preventDefault(),ve=!0,Oe(),n&&Ee(!0)}),ae.text(a.chooseText),ae.on("click.ColorPicker",function(e){e.stopPropagation(),e.preventDefault(),o.isIE&&Z.is(":focus")&&Z.trigger("change"),Z.hasClass("sp-validation-error")||(Ee(!0),ze())}),re.text(a.showPaletteOnly?a.togglePaletteMoreText:a.togglePaletteLessText),re.on("click.spectrum",function(e){e.stopPropagation(),e.preventDefault(),a.showPaletteOnly=!a.showPaletteOnly,a.showPaletteOnly||n||W.css("left","-="+($.outerWidth(!0)+5)),ke()}),Q.plugin("domx.indicator",{onmove:function(e,t,o){N=e/S,ve=!1,o.shiftKey&&(N=Math.round(10*N)/10),Oe()},onstart:be,onstop:Ce}),Y.plugin("domx.indicator",{onmove:function(e,t,o){z=parseFloat(t/T),ve=!1,a.showAlpha||(N=1),Oe()},onstart:be,onstop:Ce}),V.plugin("domx.indicator",{onmove:function(e,t,o){if(o.shiftKey){if(!D){var s=F*b,r=C-I*C,i=Math.abs(e-s)>Math.abs(t-r);D=i?"x":"y"}}else D=null;var l=!D||"y"===D;(!D||"x"===D)&&(F=parseFloat(e/b)),l&&(I=parseFloat((C-t)/C)),ve=!1,a.showAlpha||(N=1),Oe()},onstart:be,onstop:Ce}),he?(Ie(he),je(),ue=a.preferredFormat||p.parse(he).format,xe(he)):je();n&&Me();function t(e){return e.data&&e.data.ignore?(Ie(r(e.target).closest(".sp-thumb-el").data("color")),Oe()):(Ie(r(e.target).closest(".sp-thumb-el").data("color")),Oe(),a.hideAfterPaletteSelect?(Ee(!0),ze()):Ee()),!1}var s=o.isIE?"mousedown.ColorPicker":"click.ColorPicker touchstart.ColorPicker";ee.on(s,".sp-thumb-el",t),te.on(s,".sp-thumb-el:nth-child(1)",{ignore:!0},t)}(),t.mixin(this,{show:Me,hide:ze,toggle:_e,reflow:qe,option:function(e,o){if(void 0===e)return t.mixin({},a);if(void 0===o)return a[e];a[e]=o,"preferredFormat"===e&&(ue=a.preferredFormat);ke()},enable:function(){K=!1,B.attr("disabled",!1),de.removeClass("sp-disabled")},disable:Re,offset:function(e){a.offset=e,qe()},set:function(e){Ie(e),Ee()},get:Ne,destroy:function(){B.show(),de.off("click.ColorPicker touchstart.ColorPicker"),W.remove(),ce.remove(),u[spect.id]=null},container:W})}});function x(e){e.stopPropagation()}function y(e,t){var o=Array.prototype.slice,s=o.call(arguments,2);return function(){return e.apply(t,s.concat(o.call(arguments)))}}return c.register(k,"colorPicker"),k.localization={},k.palettes={},e.attach("domx.ColorPicker",k)}),e("skylark-domx-colorer/i18n/texts_ja",["../ColorPicker"],function(e){var t=e.localization.ja={cancelText:"中止",chooseText:"選択"};return t}),e("skylark-domx-colorer/i18n/texts_zh-cn",["../ColorPicker"],function(e){var t=e.localization["zh-cn"]={cancelText:"取消",chooseText:"选择",clearText:"清除",togglePaletteMoreText:"更多选项",togglePaletteLessText:"隐藏",noColorSelectedText:"尚未选择任何颜色"};return t}),e("skylark-domx-colorer/i18n/texts_zh-tw",["../ColorPicker"],function(e){var t=e.localization["zh-tw"]={cancelText:"取消",chooseText:"選擇",clearText:"清除",togglePaletteMoreText:"更多選項",togglePaletteLessText:"隱藏",noColorSelectedText:"尚未選擇任何顏色"};return t}),e("skylark-domx-colorer/main",["./ColorPicker","./i18n/texts_ja","./i18n/texts_zh-cn","./i18n/texts_zh-tw"],function(e){return e}),e("skylark-domx-colorer",["skylark-domx-colorer/main"],function(e){return e})}(o),!s){var i=require("skylark-langx-ns");a?module.exports=i:t.skylarkjs=i}}(0,this);
//# sourceMappingURL=sourcemaps/skylark-domx-colorer.js.map
